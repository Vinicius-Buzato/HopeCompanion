<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Mascote da Esperanca</title>
<style>
  /* RESET MINIMO */
  *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}
  html,body{height:100%}
  body{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#f5f8ff,#e8f0ff);color:#111;transition:background .25s,color .25s}
  .dark body, .dark{background:#0b0b0f;color:#e8eef8}
  .app{width:96vw;max-width:420px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.08);padding:14px;transition:background .2s,color .2s}
  .dark .app{background:#0f1720;box-shadow:0 6px 18px rgba(0,0,0,.45)}
  header{display:flex;gap:12px;align-items:center;margin-bottom:12px}
  .title{font-weight:700;font-size:18px}
  .subtitle{font-size:13px;color:#5b6b86}
  .dark .subtitle{color:#9fb0d9}
  /* PIXEL ART MASCOT */
  .mascot{width:84px;height:84px;flex:0 0 84px;display:flex;align-items:center;justify-content:center}
  .mascot svg{width:72px;height:72px;image-rendering:pixelated;transition:transform .2s}
  .mascot.animate svg{animation:bob 2s ease-in-out infinite}
  @keyframes bob{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
  main{display:grid;gap:10px}
  .panel{background:transparent;border-radius:8px;padding:8px}
  /* minimal buttons */
  .controls{display:flex;gap:8px}
  button{flex:1;padding:10px;border-radius:10px;border:1px solid transparent;background:linear-gradient(180deg, rgba(52,102,255,0.12), rgba(52,102,255,0.06));color:#2347d6;font-weight:700;cursor:pointer;font-size:14px;backdrop-filter:blur(2px)}
  .dark button{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));color:#bcd3ff;border:1px solid rgba(255,255,255,0.04)}
  button.ghost{background:transparent;color:#666;border:1px solid rgba(0,0,0,0.06)}
  .dark button.ghost{color:#a8bfdc;border-color:rgba(255,255,255,0.04)}
  #display{min-height:72px;background:rgba(255,255,255,0.9);border-radius:10px;display:flex;align-items:center;justify-content:center;padding:10px;text-align:center;font-size:15px;box-shadow:inset 0 1px 0 rgba(0,0,0,0.02)}
  .dark #display{background:rgba(255,255,255,0.02)}
  .mem-list{display:flex;flex-direction:column;gap:8px;max-height:180px;overflow:auto;margin-top:8px}
  .mem-item{padding:8px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfdff);font-size:14px;cursor:pointer;box-shadow:0 1px 0 rgba(0,0,0,.03)}
  .dark .mem-item{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:none;color:#dbe9ff}
  footer{margin-top:10px;font-size:12px;color:#6b7380;text-align:center}
  .top-row{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:8px}
  .toggle{display:flex;align-items:center;gap:6px;cursor:pointer;user-select:none;font-size:13px;color:#5b6b86}
  .dark .toggle{color:#9fb0d9}
  .small{font-size:13px;padding:8px}
  audio{display:none}
  /* responsive touch */
  @media (max-width:380px){button{font-size:13px;padding:9px}}
</style>
</head>
<body>
  <div class="app" role="application" aria-label="Mascote da Esperanca">
    <header>
      <div class="mascot animate" id="mascotEl" aria-hidden="true">
        <!-- PIXEL-ART TRICERATOPS (cabeca) -->
        <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <!-- base pixel grid: each rect is a "pixel" -->
          <!-- tons de roxo -->
          <rect x="0" y="0" width="32" height="32" fill="transparent"/>
          <!-- preenchimento com blocos para formar a cabeca de triceratops -->
          <!-- casco/horn pixels -->
          <rect x="2" y="6" width="4" height="4" fill="#6a3aa6"/>
          <rect x="5" y="4" width="4" height="4" fill="#6a3aa6"/>
          <rect x="8" y="4" width="6" height="6" fill="#7b4bd1"/>
          <rect x="14" y="6" width="6" height="6" fill="#8a64e6"/>
          <rect x="20" y="8" width="6" height="6" fill="#6a3aa6"/>
          <!-- chifres -->
          <rect x="22" y="2" width="2" height="4" fill="#c9a8ff"/>
          <rect x="6" y="2" width="2" height="4" fill="#c9a8ff"/>
          <!-- rosto e detalhes -->
          <rect x="10" y="10" width="12" height="10" fill="#6e3fb3"/>
          <rect x="12" y="12" width="3" height="3" fill="#fff"/>
          <rect x="17" y="12" width="3" height="3" fill="#fff"/>
          <!-- olho escuro -->
          <rect x="12" y="13" width="1" height="1" fill="#1a1a1a"/>
          <rect x="18" y="13" width="1" height="1" fill="#1a1a1a"/>
          <!-- bochecha levemente mais clara -->
          <rect x="11" y="15" width="2" height="2" fill="#8b67d6"/>
          <rect x="18" y="15" width="2" height="2" fill="#8b67d6"/>
          <!-- contorno -->
          <rect x="9" y="9" width="14" height="12" fill="none" stroke="#472569" stroke-width="0"/>
          <!-- reflexo -->
          <rect x="14" y="9" width="2" height="1" fill="#caa8ff"/>
        </svg>
      </div>
      <div style="flex:1">
        <div class="title">Mascote da Esperanca</div>
        <div class="subtitle">Um lembrete rapido: dias melhores viram</div>
      </div>
    </header>

    <main>
      <div class="top-row">
        <div class="toggle" id="darkToggle" title="Modo escuro">
          <input id="darkChk" type="checkbox"> <span id="darkLabel">Modo escuro</span>
        </div>
        <div class="toggle" id="animToggle"><input id="animChk" type="checkbox" checked> Animacoes</div>
      </div>

      <div class="panel">
        <div class="controls" style="margin-bottom:8px">
          <button id="btnPhrase">Frase motivadora</button>
          <button id="btnMem" class="ghost small">Memorias</button>
        </div>
        <div class="controls">
          <button id="btnPlay" class="small ghost">Tocar musica</button>
          <button id="btnShare" class="small">Compartilhar</button>
        </div>
      </div>

      <div id="display" class="panel">Toque em um botao para comecar</div>

      <div class="panel" id="memPanel" style="display:none">
        <div style="font-size:13px;color:#5b6b86">Memorias (toque para ver no display)</div>
        <div class="mem-list" id="memList" aria-live="polite"></div>
      </div>

    </main>

    <footer>
      Dados locais. Privacidade garantida.
    </footer>

    <audio id="audioPlayer" preload="none"></audio>
  </div>

<script>
/* APP ATUALIZADO: pixel-art, memorias internas, modo escuro */
(function(){
  const PHRASES = [
    "Voce ja passou por coisas dificeis e venceu. Confie em si.",
    "Respira. Um passo de cada vez. Dias melhores viram.",
    "Mesmo pequena, uma acao positiva tem poder.",
    "Voce e mais forte do que imagina. Continue.",
    "Lembre: ha sempre algo pelo qual ser grato hoje."
  ];

  // memorias internas - pre carregadas (base do mascote)
  const MEMORIES = [
    "Passeio no parque com amigos",
    "Terminaro aquele projeto dificil",
    "Aquele dia de risadas que nunca esqueci",
    "Conquista: aprovada naquele teste importante",
    "Cafe da manha tranquilo numa manha de sol"
  ];

  const mascotEl = document.getElementById('mascotEl');
  const btnPhrase = document.getElementById('btnPhrase');
  const display = document.getElementById('display');
  const btnMem = document.getElementById('btnMem');
  const memPanel = document.getElementById('memPanel');
  const memList = document.getElementById('memList');
  const animChk = document.getElementById('animChk');
  const animToggle = document.getElementById('animToggle');
  const btnPlay = document.getElementById('btnPlay');
  const audioPlayer = document.getElementById('audioPlayer');
  const darkChk = document.getElementById('darkChk');
  const darkToggle = document.getElementById('darkToggle');
  const btnShare = document.getElementById('btnShare');

  const LS_DARK = 'mascote_dark_v1';
  const LS_ANIM = 'mascote_anim_v1';

  // dark mode init
  function setDark(on){
    if(on) document.documentElement.classList.add('dark');
    else document.documentElement.classList.remove('dark');
    try{ localStorage.setItem(LS_DARK, on ? '1' : '0'); }catch(e){}
    darkChk.checked = !!on;
  }
  // anim init
  function setAnim(on){
    if(on) mascotEl.classList.add('animate'); else mascotEl.classList.remove('animate');
    try{ localStorage.setItem(LS_ANIM, on ? '1' : '0'); }catch(e){}
    animChk.checked = !!on;
  }

  // share (gera link e copia para area de transferencia)
  btnShare.addEventListener('click', async ()=>{
    try{
      const url = location.href;
      if(navigator.share){
        await navigator.share({title:'Mascote da Esperanca', text:'Um presente para voce', url});
      } else {
        await navigator.clipboard.writeText(url);
        alert('Link copiado. Cole no WhatsApp para compartilhar');
      }
    }catch(e){
      alert('Erro ao compartilhar');
    }
  });

  // init saved prefs
  (function initPrefs(){
    try{
      const d = localStorage.getItem(LS_DARK);
      setDark(d === '1');
      const a = localStorage.getItem(LS_ANIM);
      setAnim(a === null ? true : (a === '1'));
    }catch(e){
      setDark(false); setAnim(true);
    }
  })();

  // frases motivadoras
  btnPhrase.addEventListener('click', ()=>{
    const txt = PHRASES[Math.floor(Math.random()*PHRASES.length)];
    showDisplay(txt);
    // leve feedback visual
    mascotEl.style.transform = 'scale(1.02)';
    setTimeout(()=> mascotEl.style.transform = '', 300);
  });

  // memorias: abrir/fechar painel
  btnMem.addEventListener('click', ()=>{
    const show = memPanel.style.display !== 'block';
    memPanel.style.display = show ? 'block' : 'none';
    if(show) renderMemList();
  });

  function renderMemList(){
    memList.innerHTML = '';
    if(MEMORIES.length === 0){
      memList.innerHTML = '<div class="mem-item" style="color:#666">Nenhuma memoria disponivel</div>';
      return;
    }
    for(let i = MEMORIES.length-1; i >= 0; i--){
      const div = document.createElement('div');
      div.className = 'mem-item';
      div.textContent = MEMORIES[i];
      div.addEventListener('click', ()=> showDisplay(MEMORIES[i]));
      memList.appendChild(div);
    }
  }

  // audio: carrega apenas se existir arquivo musica.mp3 na mesma pasta
  btnPlay.addEventListener('click', async ()=>{
    if(!audioPlayer.src){
      // instrucoes para adicionar arquivo: suba 'musica.mp3' na pasta do site
      showDisplay('Coloque um arquivo "musica.mp3" na mesma pasta do site para tocar');
      return;
    }
    try{
      await audioPlayer.play();
      showDisplay('Musica tocando...');
    }catch(e){
      showDisplay('Erro ao tocar audio.');
    }
  });

  // toggles
  darkChk.addEventListener('change', ()=> setDark(darkChk.checked));
  animChk.addEventListener('change', ()=> setAnim(animChk.checked));

  // display helper
  function showDisplay(text){
    display.textContent = text;
  }

  // inicializacao: saudacao ou ultima memoria
  (function boot(){
    if(MEMORIES.length>0) showDisplay('Lembranca: ' + MEMORIES[MEMORIES.length-1]);
    else showDisplay('Bem vindo! Toque em "Frase motivadora" para comecar.');
  })();

  // optional: register service worker
  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('service-worker.js').catch(()=>{});
  }

})();
</script>
</body>
</html>
